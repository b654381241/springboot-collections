##### RabbitMQ-消息100%可靠性投递-SpringBoot2.x+定时任务实现

##### 一、可靠性投递  分为7步
* 第一步 ：首先把消息信息(业务数据) 存储到数据库表中，紧接着，我们再把这个消息记录也存到一张表中(或者另一个同源数据库的消息记录表).
* 第二步 ：发消息到RabbitMQ 的MQ Broker节点（采用confirm方式发送，会有异步的返回结果）。
* 第三步、第四步 ：生产者端接收MQ Broker 节点返回的confirm确认消息结果，然后进行更新消息记录表状态，比如默认status=0 当收到消息确认消息成功后更新为1即可
* 第五步 ：但是消息确认的这个过程可能存在网络闪断、MQ Broker端异常等原因导致，、会收消息失败、或者异常。这个时候就需要发送方(生产者)
对消息进行可靠性投递，保证消息不丢失，100%的投递成功，(有一种极限情况是闪断，Broker 返回的成功确认消息，但是由于生产端由于网络闪断没有收到，这时候重新投递可能造成
消息重复，需要消费端做幂等性处理)所以我们需要一个定时任务，（比如每5分钟拉取一下处理中间状态的消息，当然这个消息可以设置一个超时时间，比如超时1分钟
status = 0 ，也就是说明了12分钟这个时间窗口内，我们的消息没有确认，那么都会被定时任务拉去出来），
* 第六步 ：接下来我们把中间状态的消息进行重新投递 retry send ，继续发送消息到MQ ,当然也可能有多种原因导致失败。
* 第七步 ：我们可以采用设置最大努力尝试次数，比如投递了3次，还是失败了，那我们可以将最终状态 status = 2 ,最后交由人工进行干预。
